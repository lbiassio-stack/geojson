<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <title>Green Stormwater Infrastructure in Seattle</title>
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.5.0/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.5.0/mapbox-gl.js"></script>
  <style>
    body {
  margin: 0;
  padding: 0;
  overflow: hidden;
}

#map {
  position: absolute;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
}

#side-panel {
  position: absolute;
  top: 20px;
  right: 20px;
  width: 380px;
  max-height: 90vh;
  background-color: rgba(255, 255, 255, 0.95);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  border-radius: 10px;
  padding: 15px;
  overflow-y: auto;
}

h2 {
  margin-top: 0;
  font-family: Arial, sans-serif;
}

table {
  width: 100%;
  border-collapse: collapse;
  font-family: Arial, sans-serif;
  font-size: 0.9rem;
}

th, td {
  border: 1px solid #ddd;
  padding: 6px 8px;
  text-align: left;
}

tr:nth-child(even) {
  background-color: #f2f2f2;
}

  </style>
</head>

<body>
  <body>
  <div id="map"></div>

  <div id="side-panel">
    <h2>Locations where participants have received rebates from the RainWise program.</h2>
     <button id="sortBtn">Sort by Managed Runoff</button>
    <table>
      <tr>
        <th>Project Name</th>
        <th>Average Annual Runoff Volume Managed (Cubic Feet)</th>
      </tr>
    </table>
  </div>

  <script>
    // (keep your existing Mapbox + geojsonFetch code here)
  </script>
</body>


  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoibGJpYXNzaW8iLCJhIjoiY21oYXlyYXRrMHNndjJrcHlhN3Y5OWtkayJ9.7QCSMPIEHzpWxBqVNuT_cg';

    let map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/light-v10',
      zoom: 11.5,
      center: [-122.33, 47.61]
    });

    async function geojsonFetch() {
      let response, gsi, tracts;

      response = await fetch('assets/gsi.geojson');
      gsi = await response.json();

      response = await fetch('assets/seattle_tracts.geojson');
      tracts = await response.json();

      map.on('load', function() {
        map.addSource('tracts', { type: 'geojson', data: tracts });
        map.addLayer({
          id: 'tracts-layer',
          type: 'line',
          source: 'tracts',
          paint: { 'line-color': '#666', 'line-width': 1 }
        });

        map.addSource('gsi', { type: 'geojson', data: gsi });
        map.addLayer({
          id: 'gsi-layer',
          type: 'circle',
          source: 'gsi',
          paint: {
            'circle-radius': 6,
            'circle-color': '#1abc9c',
            'circle-stroke-width': 1,
            'circle-stroke-color': '#fff'
          }
        });

        let table = document.querySelector("table");
        gsi.features.forEach(f => {
          let row = table.insertRow(-1);
          row.insertCell(0).innerText = f.properties.GB_PROJECT_NAME || "N/A";
row.insertCell(1).innerText = f.properties.GB_MNGD_RNF_CBFT_NBR ?? "N/A";
        });
      });
    }
    geojsonFetch();
    
    // --- make the button interactive ---
const sortBtn = document.getElementById("sortBtn");

// when you click the button, it runs sortTable()
sortBtn.addEventListener("click", sortTable);

function sortTable() {
  const table = document.querySelector("table");
  let switching = true;

  while (switching) {
    switching = false;
    const rows = table.rows;

    for (let i = 1; i < rows.length - 1; i++) {
      let shouldSwitch = false;

      // get the numbers in the second column (index 1)
      const x = parseFloat(rows[i].getElementsByTagName("td")[1].innerText.replace(/,/g, ""));
      const y = parseFloat(rows[i + 1].getElementsByTagName("td")[1].innerText.replace(/,/g, ""));

      // compare the two numbers (descending order)
      if (x < y) {
        shouldSwitch = true;
        break;
      }
    }

    if (shouldSwitch) {
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
    }
  }
}

  </script>
</body>
</html>
